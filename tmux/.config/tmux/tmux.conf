# =============================================================================
# TMUX CONFIGURATION
# =============================================================================

# -----------------------------------------------------------------------------
# Terminal Settings
# -----------------------------------------------------------------------------
# Enable true color support for better color rendering
set-option -sa terminal-overrides ",xterm*:Tc"
set-option -g default-terminal "screen-256color"

# Reduce escape time to improve vim responsiveness
set -s escape-time 0

# -----------------------------------------------------------------------------
# Key Bindings & Prefix
# -----------------------------------------------------------------------------
# Change prefix from default Ctrl-b to Ctrl-Space for easier access
unbind C-b
set -g prefix C-Space
bind Space send-prefix

# -----------------------------------------------------------------------------
# Window & Pane Indexing
# -----------------------------------------------------------------------------
# Start window numbering at 1 instead of 0 (easier to reach on keyboard)
set -g base-index 1

# Start pane numbering at 1 instead of 0
set -g pane-base-index 1
set-window-option -g pane-base-index 1

# Automatically renumber windows when one is closed
set-option -g renumber-windows on

# -----------------------------------------------------------------------------
# Pane Navigation
# -----------------------------------------------------------------------------
# Vim-like pane navigation with repeatable keys (-r flag)
bind -r k select-pane -U    # Up
bind -r j select-pane -D    # Down
bind -r h select-pane -L    # Left
bind -r l select-pane -R    # Right

# -----------------------------------------------------------------------------
# Pane Splitting
# -----------------------------------------------------------------------------
# Split panes in current directory instead of home directory
bind '"' split-window -v -c "#{pane_current_path}"  # Vertical split
bind % split-window -h -c "#{pane_current_path}"    # Horizontal split

# Additional intuitive split bindings
bind | split-window -h -c "#{pane_current_path}"    # Pipe for horizontal
bind - split-window -v -c "#{pane_current_path}"    # Dash for vertical

# -----------------------------------------------------------------------------
# Window Management
# -----------------------------------------------------------------------------
# Create new window in current directory
bind c new-window -c "#{pane_current_path}"

# Window movement with Ctrl+Shift+Arrow keys
bind-key -n C-S-Left swap-window -d -t -1
bind-key -n C-S-Right swap-window -d -t +1

# Quick window switching with Alt+number
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5

# -----------------------------------------------------------------------------
# Pane Resizing
# -----------------------------------------------------------------------------
# Resize panes with capital vim keys (repeatable)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# -----------------------------------------------------------------------------
# Copy Mode (VI-like)
# -----------------------------------------------------------------------------
# Use vi-style key bindings in copy mode
setw -g mode-keys vi
bind [ copy-mode

# Vi-style selection and copying
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind ] paste-buffer

# -----------------------------------------------------------------------------
# Status Bar
# -----------------------------------------------------------------------------
# Configure status bar appearance and behavior
set -g status-position bottom
set -g status-justify left
set -g status-interval 5

# -----------------------------------------------------------------------------
# Session Management
# -----------------------------------------------------------------------------
# Quick session operations
bind S choose-session
bind s new-session

# -----------------------------------------------------------------------------
# Configuration Management
# -----------------------------------------------------------------------------
# Reload configuration file with visual confirmation
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Config reloaded!"

# -----------------------------------------------------------------------------
# Additional Useful Bindings
# -----------------------------------------------------------------------------
# Clear screen and history
bind C-l send-keys 'C-l'
bind C-k send-keys 'clear' \; send-keys 'Enter'

# Toggle synchronize panes (useful for running commands on multiple panes)
bind a set-window-option synchronize-panes\; display-message "synchronize-panes is now #{?pane_synchronized,on,off}"

# Kill pane/window with confirmation prompts
bind x confirm-before -p "Kill pane #P? (y/n)" kill-pane
bind X confirm-before -p "Kill window #W? (y/n)" kill-window

# -----------------------------------------------------------------------------
# Performance Settings
# -----------------------------------------------------------------------------
# Increase history limit for better scrollback
set -g history-limit 10000

# Display settings for messages and pane indicators
set -g display-time 2000
set -g display-panes-time 2000

# -----------------------------------------------------------------------------
# Activity Monitoring
# -----------------------------------------------------------------------------
# Monitor activity in windows
setw -g monitor-activity on
set -g visual-activity off
set -g bell-action none

# -----------------------------------------------------------------------------
# SSH Agent Forwarding (for VPS)
# -----------------------------------------------------------------------------
# Automatically update SSH environment variables
# set -g update-environment "SSH_ASKPASS SSH_AUTH_SOCK SSH_AGENT_PID SSH_CONNECTION"
